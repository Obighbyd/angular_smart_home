const char INDEX_HTML[] PROGMEM = R"=====(
<!DOCTYPE html> <html ng-app=myApp ng-cloak> <head> <meta charset=utf-8> <meta content=yes name=apple-mobile-web-app-capable> <title>--</title> <meta content="width=device-width,initial-scale=1" name=viewport> <link href=https://ajax.googleapis.com/ajax/libs/angular_material/1.1.0/angular-material.min.css rel=stylesheet> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet> <style>.inactive{background:#d1d1d1;opacity:.5}</style> </head> <body layout=column style=overflow-y:hidden> <div style=overflow-y:auto md-theme=custom ng-controller=dash> <md-toolbar> <div class=md-toolbar-tools> <h2 flex md-truncate>{{app_name}}</h2> <md-button class=md-icon-button> <i class=material-icons ng-click="doAction('toggle')" ng-style=getPowerStyle()>power_settings_new</i> </md-button> </div> </md-toolbar> <md-progress-linear md-mode=determinate ng-if=loc.ips_to_check.length class=md-warn value="{{ loc.ip_scan_percentage }} "></md-progress-linear> <md-tabs md-border-bottom md-dynamic-height> <md-tab label=home> <md-content> <md-list> <md-list-item class=md-2-line ng-show=!supports_percentage> <div class=md-list-item-text> <h3>Power</h3> <p>Turn the {{app_name}} {{ is_powered ? 'off' : 'on' }}</p> </div> <md-switch ng-change="doAction('master')" ng-model=is_powered></md-switch> <md-divider> </md-list-item> <md-list-item class=md-2-line ng-show=supports_percentage> <div class=md-list-item-text> <h3>{{perc_label}}: {{percentage}}</h3> </div> <div class=md-list-item-text style="padding:0 8px"> <md-slider aria-label={{perc_label}} flex max=100 min=0 ng-click="doAction('percentage')" ng-model=percentage></md-slider> </div> <md-divider> </md-list-item> <md-list-item class=md-2-line> <div class=md-list-item-text> <h3>Timer</h3> <p>{{ is_using_timer ? 'Next event in ' + next_event_due + ' mins' : 'Turn timer on' }}</p> </div> <md-switch ng-change="doAction('timer')" ng-model=is_using_timer></md-switch> <md-divider> </md-list-item> <md-list-item class=md-2-line ng-class="{ inactive: !is_using_timer }"> <div class=md-list-item-text> <h3>Skip Next</h3> <p>{{ is_using_timer ? (is_skipping_next ? 'Next scheduled event will be skipped' : 'Override the next scheduled event') : 'Requires timer mode' }}</p> </div> <md-switch ng-change="doAction('skip')" ng-model=is_skipping_next ng-disabled=!is_using_timer></md-switch> <md-divider> </md-list-item> <md-list class=md-dense layout=row layout-wrap layout-xs=column ng-class="{ inactive: !is_using_timer }"> <md-list-item class=md-3-line ng-repeat="event in events" flex=50> <div class=md-avatar> <i class=material-icons ng-if=!event.enacted style=font-size:48px>schedule</i> <i class=material-icons ng-if=event.enacted style=font-size:48px>check_circle</i> </div> <div class=md-list-item-text> <h3>{{event.time}}</h3> <h4>Enacting {{event.label}}</h4> <p ng-if=event.enacted>Performed today</p> <p ng-if=!event.enacted>Not yet performed today</p> </div> </md-list-item> </md-list> <md-divider></md-divider> </md-list> </md-content> </md-tab> <md-tab label="Networked Devices" data-if="tpl.devices.length || loc.devices.length"> <md-content> <md-list class=md-dense flex> <md-subheader ng-if=loc.devices.length>ESP8266 Devices <md-icon class=material-icons ng-click=loc_refreshDevices()>autorenew</md-icon> </md-subheader> <md-list-item class=md-2-line ng-repeat="loc_device in loc.devices track by $index"> <img alt="" class=md-avatar ng-src=https://pbs.twimg.com/profile_images/928655749605199872/ygogGX2j.jpg> <div class=md-list-item-text> <h3>{{loc_device.app_name}}</h3> <p>{{loc_device.app_desc}} - [{{loc_device.address}}]</p> </div> <md-switch ng-change=remoteRequest(loc_device.address,loc_device.on_url,loc_device.off_url,!loc_device.is_powered) ng-model=loc_device.is_powered ng-if="loc_device.off_url !== undefined"></md-switch> <md-button class="md-primary md-raised" ng-click=remoteRequest(loc_device.address,loc_device.on_url,null,false) ng-if="loc_device.off_url === undefined"> trigger</md-button> <md-divider> </md-list-item> <md-subheader ng-if=tpl.devices.length>TP-Link Devices <md-icon class=material-icons ng-click=tpl_refreshDevices()>autorenew</md-icon> </md-subheader> <md-list-item class=md-2-line ng-repeat="device in tpl.devices"> <img alt="" class=md-avatar ng-src=https://cdn-01.independent.ie/business/technology/reviews/article35225129.ece/12d93/AUTOCROP/h342/2016-11-19_bus_26361599_I1.JPG> <div class=md-list-item-text> <h3>{{device.alias}}</h3> <p>{{device.deviceModel}} - {{device.deviceName}}</p> </div> <md-switch ng-change=tpl_setState($index,device.is_powered) ng-model=device.is_powered></md-switch> <md-divider> </md-list-item> </md-list> </md-content> </md-tab> <md-tab label=Settings> <div layout=column layout-gt-sm=row> <md-card flex=50> <md-content class=md-padding> <h3>Local ESP8266 Devices</h3> <p class=md-caption> Search for local devices for the following IP range. </p> <div layout=column layout-gt-xs=row> <md-input-container flex=50> <label>Start at: 192.168.1.</label> <input ng-model=loc.ip_range_start required type=number max=255 min=1> <div ng-messages=loc.ip_range_start.$error role=alert> <div ng-message-exp="['required', 'min', 'max']"> IP Range must be between 1 and 255. </div> </div> </md-input-container> <md-input-container flex=50> <label>End at: 192.168.1:<strong>{{loc.ip_range_end}}</strong></label> <input ng-model=loc.ip_range_end required type=number max=255 min=1> <div ng-messages=loc.ip_range_end.$error role=alert> <div ng-message-exp="['required', 'min', 'max']"> IP Range must be between 1 and 255. </div> </div> </md-input-container> </div> <div layout=column layout-gt-xs=row> <md-input-container flex=50> <md-checkbox aria-label="store detected" ng-model=loc.store_detected> Allow this browser to store addresses of detected devices. </md-checkbox> </md-input-container> <md-input-container flex=50> <md-checkbox aria-label="replace detected" ng-model=loc.replace_detected> Replace existing local list with these results. </md-checkbox> </md-input-container> </div> <md-button class="md-primary md-raised md-button" ng-click=loc_detect_devices()>Detect Local Devices </md-button> <div> <br> <md-divider> <div ng-if="loc.ip_scan_percentage > 0 && loc.ip_scan_percentage < 100"> <h3>Scanning {{loc.ip_scan_percentage}}%</h3> <md-list class=md-dense flex> <md-subheader class=md-no-sticky>Local Device Queue</md-subheader> <md-list-item class=md-2-line ng-repeat="ip in loc.ips_to_check"> <div class=md-list-item-text> <h3>{{ip.ip_address}}</h3> <p>{{ (ip.checked ? "Request Sent" : "Pending") }} - {{ip.result}} <md-progress-linear md-mode=indeterminate ng-if="ip.result == 'waiting for response...'"></md-progress-linear> </p> </div> <md-divider></md-divider> </md-list-item> </md-list> </div> <h3>Current Status</h3> <p class=md-caption>Found {{loc.devices.length}} devices.</p> </div> </md-content> </md-card> <md-card flex=50> <md-content class=md-padding> <h3>TP-Link Authentication</h3> <p class=md-caption> Please provide the credentials used to connect to your TP-Link account. </p> <div layout=column layout-gt-xs=row> <md-input-container flex=50> <label>Username/Email</label> <input ng-model=tpl.username required type=email maxlength=100 minlength=10 ng-pattern=/^.+@.+\..+$/ > <div ng-messages=tpl.username.$error role=alert> <div ng-message-exp="['required', 'minlength', 'maxlength', 'pattern']"> Your email must be between 10 and 100 characters long and look like an e-mail address. </div> </div> </md-input-container> <md-input-container flex=50> <label>Password</label> <input ng-model=tpl.password required> <div ng-messages=tpl.password.$error role=alert> <div ng-message-exp="['required']"> Password must be provided. </div> </div> </md-input-container> </div> <div layout=column layout-gt-xs=row> <md-input-container flex=50> <md-checkbox aria-label="store credentials" ng-model=tpl.store_credentials> Allow this browser to store credentials. </md-checkbox> </md-input-container> <md-input-container flex=50> <md-checkbox aria-label="store token" ng-model=tpl.store_token> Allow this browser to store the authentication token. </md-checkbox> </md-input-container> </div> <md-button class="md-primary md-raised md-button" ng-click=tpl_authenticate()>Authenticate and Refresh Devices </md-button> <div ng-if="tpl.token != ''"> <br> <md-divider> <h3>Current Status</h3> <p class=md-caption>Found {{tpl.devices.length}} devices using token: <code>{{tpl.token}}</code></p> </div> </md-content> </md-card> </div> </md-tab> </md-tabs> <md-content class="md-caption md-padding"> <p>{{app_name}} <small>{{app_version}}. <br>Last sync: {{time_of_day}} <br>Last action: {{last_action}} <br><a href=/update>Update Software</a> </small> </p> </md-content> </div> <script src=https://ajax.googleapis.com/ajax/libs/angularjs//1.6.4/angular.min.js></script> <script src=https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-animate.min.js></script> <script src=https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-aria.min.js></script> <script src=https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-messages.min.js></script> <script src=https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-cookies.min.js></script> <script src=https://ajax.googleapis.com/ajax/libs/angular_material/1.1.4/angular-material.min.js></script> <script src=script.js></script>
)=====";
